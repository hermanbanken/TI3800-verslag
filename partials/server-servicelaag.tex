Onze applicatie bevat data met verschillende relevantie over tijd. Tijdens het sporten zijn vooral doorkomsten interessant evenals informatie over de actuele training. Ná het sporten zijn vergelijkingen met andere sporters interessant en analyses op de training. Zowel SignalR\footnote{\url{http://www.asp.net/signalr}} als WebApi\footnote{\url{http://www.asp.net/web-api}} zijn technieken om data door te sturen, maar SignalR is gemaakt voor live data en WebApi voor het toegankelijk maken van al bestaande data via een REST API~\footnote{\url{http://en.wikipedia.org/wiki/Representational_state_transfer}}. In onze applicatie gebruiken we dan ook beide technieken naast elkaar. Een derde techniek die we gebruiken is OWIN~\footnote{\url{http://www.asp.net/aspnet/overview/owin-and-katana}}, een brug tussen de webserver en de web-applicatie. OWIN verzorgt het opstarten en configureren van de web-applicatie.

\subsection{SignalR}
SignalR onderhoudt een continue verbinding tussen server en client waarbij het zelf zorgt voor het juiste onderliggende protocol. SignalR werkt bij voorkeur over WebSockets, maar werkt ook met oudere browsers door gebruik te maken van ``polling''. Bij polling houdt de server de verbinding zolang mogelijk open. Als er een bericht afgeleverd moet worden wordt deze verstuurd, de verbinding wordt gesloten, en er wordt weer een nieuwe verbinding gemaakt. Door gebruik te maken van SignalR hoeven we ons niet bezig te houden met de werking van deze ingewikkelde protocollen, en kunnen we eenvoudig een verbinding opzetten.

Naast het beheren van de individuele verbindingen, onderhoudt SignalR ook virtuele groepen. Een nieuw bericht kan gestuurd worden naar individuele gebruikers, maar ook naar deze groepen. Wij gebruiken de groepen als interesse-context: in onze applicatie kunnen gebruikers een scherm open hebben van een baan of een (vrienden)groep, ze zijn dan geïnteresseerd in de updates van alle gebruikers in die context. Wanneer één van de leden van de context aan het schaatsen is, en er moet een update gestuurd worden, dan sturen we met één commando aan iedereen die in die context een update.

\subsection{WebApi}
De API die we gemaakt hebben met WebApi 2.0 ontsluit data die niet ``live'' is. Onder andere de registratie en het ophalen van profieldata, groepen, favorieten en banen gebeuren via WebApi. WebApi heeft als voordeel dat het te gebruiken is zónder een SignalR client en ook dat het makkelijker te debuggen is dan SignalR, omdat er geen  websocketverbinding gemaakt hoeft te worden. Door een API aan te bieden kan ons platform in de toekomst ook gemakkelijk gebruik worden voor andere applicaties.

\subsection{OWIN}
Zowel SignalR als WebApi zijn als 'middleware' geconfigureerd in het opstartscript van OWIN. OWIN zorgt er voor dat een binnenkomend verzoek wordt afgehandeld door die middleware die het verzoek kan afhandelen. Zo worden verzoeken naar de api doorgestuurd naar WebApi en verzoeken naar de url /signalr worden doorgestuurd naar SignalR. 

In OWIN hebben we ook OAuth geconfigureerd. OAuth is een authenticatiestandaard waarbij een gebruiker kan inloggen met zijn gebruikersnaam en wachtwoord of via een externe dienst zoals Facebook. De client krijgt dan een ``token'', een sleutel, die meegestuurd moet worden met opvolgende verzoeken. Hiermee is de authenticatie centraal geregeld, want zowel SignalR als WebApi kunnen hier mee overweg.